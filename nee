# --- Execução da Requisição ---
print("Iniciando busca por traces com Status 200 (Sucesso)...")

try:
    response = requests.post(url, headers=headers, json=payload)
    response.raise_for_status() 

    data = response.json()
    print(f"Status da Resposta HTTP: {response.status_code}")

    # --- Processamento dos Dados ---
    traces_list = []
    
    if 'data' in data and data['data']:
        print(f"Traces (Status 200) encontrados: {len(data['data'])}")

        for trace_event in data['data']:
            attributes = trace_event.get('attributes', {})
            
            traces_list.append({
                'trace_id': attributes.get('trace_id'),
                'service': attributes.get('service'),
                # Extrai o status_code do campo http (deve ser 200 devido ao filtro)
                'status_code': attributes.get('http', {}).get('status_code'),
                'timestamp': attributes.get('timestamp')
            })

        # Criação do DataFrame
        df_traces = pd.DataFrame(traces_list)

        print("\n--- DataFrame de Sucessos (200) ---")
        print(df_traces[['trace_id', 'service', 'status_code', 'timestamp']].head())

    else:
        print("Nenhum trace com Status 200 encontrado com o filtro especificado.")
        
except requests.exceptions.RequestException as err:
    print(f"Ocorreu um erro na requisição: {err}")
